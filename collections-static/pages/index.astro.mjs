import { e as createComponent, k as renderComponent, r as renderTemplate, n as defineScriptVars, h as addAttribute, m as maybeRenderHead } from '../chunks/astro/server_CzBadtu_.mjs';
import 'kleur/colors';
import { c as collectionsData, $ as $$Layout } from '../chunks/collections_C7tZf6go.mjs';
/* empty css                                 */
export { renderers } from '../renderers.mjs';

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Index = createComponent(async ($$result, $$props, $$slots) => {
  const { categories, collections } = collectionsData;
  collections.sort((a, b) => new Date(b.updated) - new Date(a.updated));
  const platformMap = {
    "115": { name: "115\u7F51\u76D8", icon: "fa-box", color: "bg-orange-500" },
    "123": { name: "123\u7F51\u76D8", icon: "fa-hashtag", color: "bg-green-500" },
    "mobile": { name: "\u79FB\u52A8\u4E91\u76D8", icon: "fa-mobile-alt", color: "bg-blue-500" },
    "xunlei": { name: "\u8FC5\u96F7\u4E91\u76D8", icon: "fa-bolt", color: "bg-yellow-500" },
    "aliyun": { name: "\u963F\u91CC\u4E91\u76D8", icon: "fa-cloud", color: "bg-purple-500" },
    "uc": { name: "UC\u7F51\u76D8", icon: "fa-compass", color: "bg-red-500" },
    "tianyi": { name: "\u5929\u7FFC\u4E91\u76D8", icon: "fa-cloud", color: "bg-pink-500" },
    "quark": { name: "\u5938\u514B\u7F51\u76D8", icon: "fa-search", color: "bg-indigo-500" },
    "others": { name: "\u5176\u4ED6\u7F51\u76D8", icon: "fa-ellipsis-h", color: "bg-gray-500" },
    "baidu": { name: "\u767E\u5EA6\u7F51\u76D8", icon: "fa-database", color: "bg-blue-600" }
  };
  return renderTemplate`${renderComponent($$result, "Layout", $$Layout, { "title": "\u8D44\u6E90\u96C6\u5408 - \u76D8\u641C", "data-astro-cid-j7pv25f6": true }, { "default": async ($$result2) => renderTemplate(_a || (_a = __template([" ", '<div class="max-w-6xl mx-auto" data-astro-cid-j7pv25f6> <!-- \u6807\u9898\u533A\u57DF --> <div class="text-center mb-10 fade-in" data-astro-cid-j7pv25f6> <div class="w-16 h-16 flex items-center justify-center mx-auto mb-4" data-astro-cid-j7pv25f6> <img src="/logo.png" alt="\u76D8\u641C Logo" class="w-full h-full object-contain" data-astro-cid-j7pv25f6> </div> <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-ios-blue to-blue-500 bg-clip-text text-transparent" data-astro-cid-j7pv25f6>\u8D44\u6E90\u96C6\u5408</h1> <p class="text-ios-gray text-lg" data-astro-cid-j7pv25f6>\u7CBE\u5FC3\u6574\u7406\u7684\u4F18\u8D28\u8D44\u6E90\u5408\u96C6,\u9646\u7EED\u66F4\u65B0\u4E2D...</p> <div class="mt-4" data-astro-cid-j7pv25f6> <a href="/" class="text-ios-blue hover:underline text-sm" data-astro-cid-j7pv25f6>\u2190 \u8FD4\u56DE\u641C\u7D22\u9875\u9762</a> </div> </div>  <!-- \u5206\u7C7B\u5BFC\u822A --> <div class="mb-8" data-astro-cid-j7pv25f6> <div class="flex overflow-x-auto no-scrollbar py-2 gap-3 justify-start md:justify-center" data-astro-cid-j7pv25f6> <button class="category-tab active" data-category="all" data-astro-cid-j7pv25f6> <i class="fas fa-th-large mr-2" data-astro-cid-j7pv25f6></i>\u5168\u90E8\n</button> ', ' </div> </div> <!-- \u7B5B\u9009\u548C\u6392\u5E8F --> <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mb-8" data-astro-cid-j7pv25f6> <!-- \u641C\u7D22\u6846 --> <div class="ios-card p-1 search-box flex-grow w-full sm:w-auto" data-astro-cid-j7pv25f6> <div class="flex items-center" data-astro-cid-j7pv25f6> <div class="pl-4 text-ios-gray" data-astro-cid-j7pv25f6> <i class="fas fa-search" data-astro-cid-j7pv25f6></i> </div> <input type="text" id="collectionSearch" placeholder="\u641C\u7D22\u96C6\u5408\u6216\u6807\u7B7E..." class="w-full py-3 px-4 bg-transparent outline-none text-base placeholder-ios-gray" autocomplete="off" data-astro-cid-j7pv25f6> </div> </div> <!-- \u6392\u5E8F\u65B9\u5F0F --> <div id="sort-container" class="flex items-center gap-2" data-astro-cid-j7pv25f6> <button class="sort-button active" data-sort="updated" data-astro-cid-j7pv25f6> <i class="fas fa-sync-alt mr-1" data-astro-cid-j7pv25f6></i>\u6309\u66F4\u65B0\n</button> <button class="sort-button" data-sort="views" data-astro-cid-j7pv25f6> <i class="fas fa-fire mr-1" data-astro-cid-j7pv25f6></i>\u6309\u70ED\u5EA6\n</button> <button class="sort-button" data-sort="created" data-astro-cid-j7pv25f6> <i class="fas fa-calendar-plus mr-1" data-astro-cid-j7pv25f6></i>\u6309\u521B\u5EFA\n</button> </div> </div> <!-- \u96C6\u5408\u5C55\u793A\u533A\u57DF --> <div id="collectionsContainer" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3" data-astro-cid-j7pv25f6> ', ' </div> <!-- \u5206\u9875\u63A7\u4EF6 --> <div class="mt-8 flex justify-center" data-astro-cid-j7pv25f6> <div id="pagination" class="flex items-center space-x-2" data-astro-cid-j7pv25f6> <button id="firstPage" class="ios-button px-3 py-1 rounded" data-astro-cid-j7pv25f6> <i class="fas fa-angle-double-left" data-astro-cid-j7pv25f6></i> </button> <button id="prevPage" class="ios-button px-3 py-1 rounded" data-astro-cid-j7pv25f6> <i class="fas fa-angle-left" data-astro-cid-j7pv25f6></i> </button> <span id="pageInfo" class="text-ios-gray mx-2" data-astro-cid-j7pv25f6></span> <button id="nextPage" class="ios-button px-3 py-1 rounded" data-astro-cid-j7pv25f6> <i class="fas fa-angle-right" data-astro-cid-j7pv25f6></i> </button> <button id="lastPage" class="ios-button px-3 py-1 rounded" data-astro-cid-j7pv25f6> <i class="fas fa-angle-double-right" data-astro-cid-j7pv25f6></i> </button> </div> </div> <!-- \u9875\u811A --> <div class="mt-12 text-center text-ios-gray" data-astro-cid-j7pv25f6> <p class="text-sm" data-astro-cid-j7pv25f6> <a href="/" class="text-ios-blue hover:underline" data-astro-cid-j7pv25f6>\u8FD4\u56DE\u641C\u7D22\u9875\u9762</a> </p> </div> </div> <script>(function(){', "\n    // DOM \u5143\u7D20\n    const categoryTabs = document.querySelectorAll('.category-tab');\n    const searchInput = document.getElementById('collectionSearch');\n    const sortButtons = document.querySelectorAll('.sort-button');\n    const collectionsContainer = document.getElementById('collectionsContainer');\n    \n    // \u5206\u9875\u76F8\u5173\u5143\u7D20\n    const firstPageBtn = document.getElementById('firstPage');\n    const prevPageBtn = document.getElementById('prevPage');\n    const nextPageBtn = document.getElementById('nextPage');\n    const lastPageBtn = document.getElementById('lastPage');\n    const pageInfoSpan = document.getElementById('pageInfo');\n    \n    let allCollectionCards = Array.from(document.querySelectorAll('.collection-card'));\n    \n    // \u5206\u9875\u914D\u7F6E\n    const ITEMS_PER_PAGE = 9; // \u6BCF\u9875\u663E\u793A\u7684\u96C6\u5408\u6570\u91CF\n    let currentPage = 1; // \u5F53\u524D\u9875\u7801\n\n    // \u6E32\u67D3\u96C6\u5408\uFF08\u5E26\u5206\u9875\uFF09\n    function renderCollections(cards) {\n        // \u8BA1\u7B97\u603B\u9875\u6570\n        const totalPages = Math.ceil(cards.length / ITEMS_PER_PAGE);\n        \n        // \u786E\u4FDD\u5F53\u524D\u9875\u7801\u5728\u6709\u6548\u8303\u56F4\u5185\n        if (currentPage < 1) currentPage = 1;\n        if (currentPage > totalPages && totalPages > 0) currentPage = totalPages;\n        if (totalPages === 0) currentPage = 1;\n        \n        // \u8BA1\u7B97\u5F53\u524D\u9875\u8981\u663E\u793A\u7684\u96C6\u5408\n        const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;\n        const endIndex = Math.min(startIndex + ITEMS_PER_PAGE, cards.length);\n        const pageCards = cards.slice(startIndex, endIndex);\n        \n        // \u6E32\u67D3\u96C6\u5408\n        collectionsContainer.innerHTML = '';\n        pageCards.forEach(card => {\n            collectionsContainer.appendChild(card);\n        });\n        \n        // \u66F4\u65B0\u5206\u9875\u63A7\u4EF6\n        updatePagination(totalPages);\n    }\n    \n    // \u66F4\u65B0\u5206\u9875\u63A7\u4EF6\n    function updatePagination(totalPages) {\n        // \u663E\u793A\u9875\u7801\u4FE1\u606F\n        if (totalPages > 0) {\n            pageInfoSpan.textContent = `${currentPage} / ${totalPages}`;\n        } else {\n            pageInfoSpan.textContent = '0 / 0';\n        }\n        \n        // \u66F4\u65B0\u6309\u94AE\u72B6\u6001\n        firstPageBtn.disabled = currentPage <= 1;\n        prevPageBtn.disabled = currentPage <= 1;\n        nextPageBtn.disabled = currentPage >= totalPages || totalPages === 0;\n        lastPageBtn.disabled = currentPage >= totalPages || totalPages === 0;\n        \n        // \u6DFB\u52A0\u6309\u94AE\u6837\u5F0F\n        const buttons = [firstPageBtn, prevPageBtn, nextPageBtn, lastPageBtn];\n        buttons.forEach(btn => {\n            if (btn.disabled) {\n                btn.classList.add('opacity-50', 'cursor-not-allowed');\n                btn.classList.remove('hover:opacity-90');\n            } else {\n                btn.classList.remove('opacity-50', 'cursor-not-allowed');\n                btn.classList.add('hover:opacity-90');\n            }\n        });\n    }\n    \n    // \u6392\u5E8F\u51FD\u6570\n    function sortCollections(cards, sortBy) {\n        return [...cards].sort((a, b) => {\n            const aValue = a.dataset[sortBy];\n            const bValue = b.dataset[sortBy];\n\n            if (sortBy === 'views') {\n                return parseInt(bValue, 10) - parseInt(aValue, 10);\n            }\n            // For dates, we want descending order\n            return new Date(bValue) - new Date(aValue);\n        });\n    }\n\n    // \u7B5B\u9009\u548C\u6392\u5E8F\u4E3B\u51FD\u6570\n    function filterAndSort() {\n        const activeCategory = document.querySelector('.category-tab.active').dataset.category;\n        const searchTerm = searchInput.value.toLowerCase();\n        const sortBy = document.querySelector('.sort-button.active').dataset.sort;\n\n        // 1. \u7B5B\u9009\n        let filteredCards = allCollectionCards.filter(card => {\n            const cardCategory = card.dataset.category;\n            const cardTags = card.dataset.tags;\n            const cardTitle = card.querySelector('h3').textContent.toLowerCase();\n            \n            const matchesCategory = activeCategory === 'all' || cardCategory === activeCategory;\n            const matchesSearch = !searchTerm || cardTitle.includes(searchTerm) || cardTags.includes(searchTerm);\n            \n            return matchesCategory && matchesSearch;\n        });\n\n        // 2. \u6392\u5E8F\n        const sortedCards = sortCollections(filteredCards, sortBy);\n        \n        // 3. \u91CD\u7F6E\u5230\u7B2C\u4E00\u9875\n        currentPage = 1;\n        \n        // 4. \u6E32\u67D3\n        renderCollections(sortedCards);\n    }\n    \n    // \u5206\u9875\u63A7\u5236\u51FD\u6570\n    function goToPage(page) {\n        currentPage = page;\n        filterAndSort(); // \u91CD\u65B0\u6E32\u67D3\u5F53\u524D\u9875\n    }\n    \n    function goToFirstPage() {\n        goToPage(1);\n    }\n    \n    function goToPrevPage() {\n        if (currentPage > 1) {\n            goToPage(currentPage - 1);\n        }\n    }\n    \n    function goToNextPage() {\n        // \u603B\u9875\u6570\u4F1A\u5728renderCollections\u4E2D\u8BA1\u7B97\uFF0C\u8FD9\u91CC\u7B80\u5355\u5904\u7406\n        goToPage(currentPage + 1);\n    }\n    \n    function goToLastPage() {\n        // \u603B\u9875\u6570\u4F1A\u5728renderCollections\u4E2D\u8BA1\u7B97\uFF0C\u8FD9\u91CC\u7B80\u5355\u5904\u7406\n        goToPage(9999); // \u4E00\u4E2A\u8DB3\u591F\u5927\u7684\u6570\uFF0C\u4F1A\u5728renderCollections\u4E2D\u88AB\u4FEE\u6B63\n    }\n\n    // \u4E8B\u4EF6\u76D1\u542C\n    categoryTabs.forEach(tab => {\n        tab.addEventListener('click', () => {\n            categoryTabs.forEach(t => t.classList.remove('active'));\n            tab.classList.add('active');\n            filterAndSort();\n        });\n    });\n\n    searchInput.addEventListener('input', filterAndSort);\n    sortButtons.forEach(button => {\n        button.addEventListener('click', () => {\n            sortButtons.forEach(btn => btn.classList.remove('active'));\n            button.classList.add('active');\n            filterAndSort();\n        });\n    });\n    \n    // \u5206\u9875\u6309\u94AE\u4E8B\u4EF6\u76D1\u542C\n    firstPageBtn.addEventListener('click', goToFirstPage);\n    prevPageBtn.addEventListener('click', goToPrevPage);\n    nextPageBtn.addEventListener('click', goToNextPage);\n    lastPageBtn.addEventListener('click', goToLastPage);\n\n    // \u83B7\u53D6\u5E76\u66F4\u65B0\u6240\u6709\u8BBF\u95EE\u6B21\u6570\n    async function fetchAllViews() {\n        console.log('fetchAllViews called');\n        try {\n            const response = await fetch('/api/get-all-views');\n            console.log('API response status:', response.status);\n            if (!response.ok) {\n                console.log('API response not ok');\n                return;\n            }\n            const views = await response.json();\n            console.log('Data received from API:', views);\n            \n            allCollectionCards.forEach(card => {\n                const collectionId = card.dataset.id;\n                if (views[collectionId] !== undefined) {\n                    const viewCountSpan = card.querySelector('.view-count');\n                    if (viewCountSpan) {\n                        viewCountSpan.textContent = views[collectionId];\n                    }\n                    // \u66F4\u65B0\u5361\u7247\u4E0A\u7684 data-views \u5C5E\u6027\u4EE5\u4FBF\u6392\u5E8F\n                    card.dataset.views = views[collectionId];\n                }\n            });\n            // \u83B7\u53D6\u6570\u636E\u540E\u91CD\u65B0\u6392\u5E8F\u548C\u6E32\u67D3\n            filterAndSort();\n        } catch (error) {\n            console.error('Failed to fetch all views:', error);\n        }\n    }\n\n    // \u521D\u59CB\u52A0\u8F7D\n    window.addEventListener('pageshow', (event) => {\n        // \u6BCF\u6B21\u9875\u9762\u663E\u793A\u65F6\u90FD\u83B7\u53D6\u6700\u65B0\u6570\u636E\n        fetchAllViews();\n        // \u5982\u679C\u9875\u9762\u662F\u4ECE\u7F13\u5B58\u4E2D\u52A0\u8F7D\u7684\uFF0C\u6211\u4EEC\u53EF\u80FD\u9700\u8981\u91CD\u65B0\u521D\u59CB\u5316\u4E00\u4E9B\u72B6\u6001\n        if (event.persisted) {\n            console.log(\"Page was loaded from the cache.\");\n            // \u53EF\u4EE5\u5728\u8FD9\u91CC\u6DFB\u52A0\u9700\u8981\u91CD\u65B0\u521D\u59CB\u5316\u7684\u903B\u8F91\n        }\n        // \u786E\u4FDD\u7B5B\u9009\u548C\u6392\u5E8F\u5728\u6570\u636E\u66F4\u65B0\u540E\u6267\u884C\n        // fetchAllViews \u5185\u90E8\u5DF2\u7ECF\u8C03\u7528\u4E86 filterAndSort\n    });\n\n    // \u9875\u9762\u521D\u6B21\u52A0\u8F7D\u65F6\uFF0C\u4E5F\u6267\u884C\u4E00\u6B21\u6392\u5E8F\n    filterAndSort();\n\n        // \u6392\u5E8F\u51FD\u6570\n        function sortCollections(cards, sortBy) {\n            return [...cards].sort((a, b) => {\n                const aValue = a.dataset[sortBy];\n                const bValue = b.dataset[sortBy];\n\n                if (sortBy === 'views') {\n                    return parseInt(bValue, 10) - parseInt(aValue, 10);\n                }\n                // For dates, we want descending order\n                return new Date(bValue) - new Date(aValue);\n            });\n        }\n\n        // \u7B5B\u9009\u548C\u6392\u5E8F\u4E3B\u51FD\u6570\n        function filterAndSort() {\n            const activeCategory = document.querySelector('.category-tab.active').dataset.category;\n            const searchTerm = searchInput.value.toLowerCase();\n            const sortBy = document.querySelector('.sort-button.active').dataset.sort;\n\n            // 1. \u7B5B\u9009\n            let filteredCards = allCollectionCards.filter(card => {\n                const cardCategory = card.dataset.category;\n                const cardTags = card.dataset.tags;\n                const cardTitle = card.querySelector('h3').textContent.toLowerCase();\n                \n                const matchesCategory = activeCategory === 'all' || cardCategory === activeCategory;\n                const matchesSearch = !searchTerm || cardTitle.includes(searchTerm) || cardTags.includes(searchTerm);\n                \n                return matchesCategory && matchesSearch;\n            });\n\n            // 2. \u6392\u5E8F\n            const sortedCards = sortCollections(filteredCards, sortBy);\n            \n            // 3. \u6E32\u67D3\n            renderCollections(sortedCards);\n        }\n\n        // \u4E8B\u4EF6\u76D1\u542C\n        categoryTabs.forEach(tab => {\n            tab.addEventListener('click', () => {\n                categoryTabs.forEach(t => t.classList.remove('active'));\n                tab.classList.add('active');\n                filterAndSort();\n            });\n        });\n\n        searchInput.addEventListener('input', filterAndSort);\n        sortButtons.forEach(button => {\n            button.addEventListener('click', () => {\n                sortButtons.forEach(btn => btn.classList.remove('active'));\n                button.classList.add('active');\n                filterAndSort();\n            });\n        });\n\n        // \u83B7\u53D6\u5E76\u66F4\u65B0\u6240\u6709\u8BBF\u95EE\u6B21\u6570\n        async function fetchAllViews() {\n            console.log('fetchAllViews called');\n            try {\n                const response = await fetch('/api/get-all-views');\n                console.log('API response status:', response.status);\n                if (!response.ok) {\n                    console.log('API response not ok');\n                    return;\n                }\n                const views = await response.json();\n                console.log('Data received from API:', views);\n                \n                allCollectionCards.forEach(card => {\n                    const collectionId = card.dataset.id;\n                    if (views[collectionId] !== undefined) {\n                        const viewCountSpan = card.querySelector('.view-count');\n                        if (viewCountSpan) {\n                            viewCountSpan.textContent = views[collectionId];\n                        }\n                        // \u66F4\u65B0\u5361\u7247\u4E0A\u7684 data-views \u5C5E\u6027\u4EE5\u4FBF\u6392\u5E8F\n                        card.dataset.views = views[collectionId];\n                    }\n                });\n                // \u83B7\u53D6\u6570\u636E\u540E\u91CD\u65B0\u6392\u5E8F\u548C\u6E32\u67D3\n                filterAndSort();\n            } catch (error) {\n                console.error('Failed to fetch all views:', error);\n            }\n        }\n\n        // \u521D\u59CB\u52A0\u8F7D\n        window.addEventListener('pageshow', (event) => {\n            // \u6BCF\u6B21\u9875\u9762\u663E\u793A\u65F6\u90FD\u83B7\u53D6\u6700\u65B0\u6570\u636E\n            fetchAllViews();\n            // \u5982\u679C\u9875\u9762\u662F\u4ECE\u7F13\u5B58\u4E2D\u52A0\u8F7D\u7684\uFF0C\u6211\u4EEC\u53EF\u80FD\u9700\u8981\u91CD\u65B0\u521D\u59CB\u5316\u4E00\u4E9B\u72B6\u6001\n            if (event.persisted) {\n                console.log(\"Page was loaded from the cache.\");\n                // \u53EF\u4EE5\u5728\u8FD9\u91CC\u6DFB\u52A0\u9700\u8981\u91CD\u65B0\u521D\u59CB\u5316\u7684\u903B\u8F91\n            }\n            // \u786E\u4FDD\u7B5B\u9009\u548C\u6392\u5E8F\u5728\u6570\u636E\u66F4\u65B0\u540E\u6267\u884C\n            // fetchAllViews \u5185\u90E8\u5DF2\u7ECF\u8C03\u7528\u4E86 filterAndSort\n        });\n\n})();<\/script> "], [" ", '<div class="max-w-6xl mx-auto" data-astro-cid-j7pv25f6> <!-- \u6807\u9898\u533A\u57DF --> <div class="text-center mb-10 fade-in" data-astro-cid-j7pv25f6> <div class="w-16 h-16 flex items-center justify-center mx-auto mb-4" data-astro-cid-j7pv25f6> <img src="/logo.png" alt="\u76D8\u641C Logo" class="w-full h-full object-contain" data-astro-cid-j7pv25f6> </div> <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-ios-blue to-blue-500 bg-clip-text text-transparent" data-astro-cid-j7pv25f6>\u8D44\u6E90\u96C6\u5408</h1> <p class="text-ios-gray text-lg" data-astro-cid-j7pv25f6>\u7CBE\u5FC3\u6574\u7406\u7684\u4F18\u8D28\u8D44\u6E90\u5408\u96C6,\u9646\u7EED\u66F4\u65B0\u4E2D...</p> <div class="mt-4" data-astro-cid-j7pv25f6> <a href="/" class="text-ios-blue hover:underline text-sm" data-astro-cid-j7pv25f6>\u2190 \u8FD4\u56DE\u641C\u7D22\u9875\u9762</a> </div> </div>  <!-- \u5206\u7C7B\u5BFC\u822A --> <div class="mb-8" data-astro-cid-j7pv25f6> <div class="flex overflow-x-auto no-scrollbar py-2 gap-3 justify-start md:justify-center" data-astro-cid-j7pv25f6> <button class="category-tab active" data-category="all" data-astro-cid-j7pv25f6> <i class="fas fa-th-large mr-2" data-astro-cid-j7pv25f6></i>\u5168\u90E8\n</button> ', ' </div> </div> <!-- \u7B5B\u9009\u548C\u6392\u5E8F --> <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mb-8" data-astro-cid-j7pv25f6> <!-- \u641C\u7D22\u6846 --> <div class="ios-card p-1 search-box flex-grow w-full sm:w-auto" data-astro-cid-j7pv25f6> <div class="flex items-center" data-astro-cid-j7pv25f6> <div class="pl-4 text-ios-gray" data-astro-cid-j7pv25f6> <i class="fas fa-search" data-astro-cid-j7pv25f6></i> </div> <input type="text" id="collectionSearch" placeholder="\u641C\u7D22\u96C6\u5408\u6216\u6807\u7B7E..." class="w-full py-3 px-4 bg-transparent outline-none text-base placeholder-ios-gray" autocomplete="off" data-astro-cid-j7pv25f6> </div> </div> <!-- \u6392\u5E8F\u65B9\u5F0F --> <div id="sort-container" class="flex items-center gap-2" data-astro-cid-j7pv25f6> <button class="sort-button active" data-sort="updated" data-astro-cid-j7pv25f6> <i class="fas fa-sync-alt mr-1" data-astro-cid-j7pv25f6></i>\u6309\u66F4\u65B0\n</button> <button class="sort-button" data-sort="views" data-astro-cid-j7pv25f6> <i class="fas fa-fire mr-1" data-astro-cid-j7pv25f6></i>\u6309\u70ED\u5EA6\n</button> <button class="sort-button" data-sort="created" data-astro-cid-j7pv25f6> <i class="fas fa-calendar-plus mr-1" data-astro-cid-j7pv25f6></i>\u6309\u521B\u5EFA\n</button> </div> </div> <!-- \u96C6\u5408\u5C55\u793A\u533A\u57DF --> <div id="collectionsContainer" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3" data-astro-cid-j7pv25f6> ', ' </div> <!-- \u5206\u9875\u63A7\u4EF6 --> <div class="mt-8 flex justify-center" data-astro-cid-j7pv25f6> <div id="pagination" class="flex items-center space-x-2" data-astro-cid-j7pv25f6> <button id="firstPage" class="ios-button px-3 py-1 rounded" data-astro-cid-j7pv25f6> <i class="fas fa-angle-double-left" data-astro-cid-j7pv25f6></i> </button> <button id="prevPage" class="ios-button px-3 py-1 rounded" data-astro-cid-j7pv25f6> <i class="fas fa-angle-left" data-astro-cid-j7pv25f6></i> </button> <span id="pageInfo" class="text-ios-gray mx-2" data-astro-cid-j7pv25f6></span> <button id="nextPage" class="ios-button px-3 py-1 rounded" data-astro-cid-j7pv25f6> <i class="fas fa-angle-right" data-astro-cid-j7pv25f6></i> </button> <button id="lastPage" class="ios-button px-3 py-1 rounded" data-astro-cid-j7pv25f6> <i class="fas fa-angle-double-right" data-astro-cid-j7pv25f6></i> </button> </div> </div> <!-- \u9875\u811A --> <div class="mt-12 text-center text-ios-gray" data-astro-cid-j7pv25f6> <p class="text-sm" data-astro-cid-j7pv25f6> <a href="/" class="text-ios-blue hover:underline" data-astro-cid-j7pv25f6>\u8FD4\u56DE\u641C\u7D22\u9875\u9762</a> </p> </div> </div> <script>(function(){', "\n    // DOM \u5143\u7D20\n    const categoryTabs = document.querySelectorAll('.category-tab');\n    const searchInput = document.getElementById('collectionSearch');\n    const sortButtons = document.querySelectorAll('.sort-button');\n    const collectionsContainer = document.getElementById('collectionsContainer');\n    \n    // \u5206\u9875\u76F8\u5173\u5143\u7D20\n    const firstPageBtn = document.getElementById('firstPage');\n    const prevPageBtn = document.getElementById('prevPage');\n    const nextPageBtn = document.getElementById('nextPage');\n    const lastPageBtn = document.getElementById('lastPage');\n    const pageInfoSpan = document.getElementById('pageInfo');\n    \n    let allCollectionCards = Array.from(document.querySelectorAll('.collection-card'));\n    \n    // \u5206\u9875\u914D\u7F6E\n    const ITEMS_PER_PAGE = 9; // \u6BCF\u9875\u663E\u793A\u7684\u96C6\u5408\u6570\u91CF\n    let currentPage = 1; // \u5F53\u524D\u9875\u7801\n\n    // \u6E32\u67D3\u96C6\u5408\uFF08\u5E26\u5206\u9875\uFF09\n    function renderCollections(cards) {\n        // \u8BA1\u7B97\u603B\u9875\u6570\n        const totalPages = Math.ceil(cards.length / ITEMS_PER_PAGE);\n        \n        // \u786E\u4FDD\u5F53\u524D\u9875\u7801\u5728\u6709\u6548\u8303\u56F4\u5185\n        if (currentPage < 1) currentPage = 1;\n        if (currentPage > totalPages && totalPages > 0) currentPage = totalPages;\n        if (totalPages === 0) currentPage = 1;\n        \n        // \u8BA1\u7B97\u5F53\u524D\u9875\u8981\u663E\u793A\u7684\u96C6\u5408\n        const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;\n        const endIndex = Math.min(startIndex + ITEMS_PER_PAGE, cards.length);\n        const pageCards = cards.slice(startIndex, endIndex);\n        \n        // \u6E32\u67D3\u96C6\u5408\n        collectionsContainer.innerHTML = '';\n        pageCards.forEach(card => {\n            collectionsContainer.appendChild(card);\n        });\n        \n        // \u66F4\u65B0\u5206\u9875\u63A7\u4EF6\n        updatePagination(totalPages);\n    }\n    \n    // \u66F4\u65B0\u5206\u9875\u63A7\u4EF6\n    function updatePagination(totalPages) {\n        // \u663E\u793A\u9875\u7801\u4FE1\u606F\n        if (totalPages > 0) {\n            pageInfoSpan.textContent = \\`\\${currentPage} / \\${totalPages}\\`;\n        } else {\n            pageInfoSpan.textContent = '0 / 0';\n        }\n        \n        // \u66F4\u65B0\u6309\u94AE\u72B6\u6001\n        firstPageBtn.disabled = currentPage <= 1;\n        prevPageBtn.disabled = currentPage <= 1;\n        nextPageBtn.disabled = currentPage >= totalPages || totalPages === 0;\n        lastPageBtn.disabled = currentPage >= totalPages || totalPages === 0;\n        \n        // \u6DFB\u52A0\u6309\u94AE\u6837\u5F0F\n        const buttons = [firstPageBtn, prevPageBtn, nextPageBtn, lastPageBtn];\n        buttons.forEach(btn => {\n            if (btn.disabled) {\n                btn.classList.add('opacity-50', 'cursor-not-allowed');\n                btn.classList.remove('hover:opacity-90');\n            } else {\n                btn.classList.remove('opacity-50', 'cursor-not-allowed');\n                btn.classList.add('hover:opacity-90');\n            }\n        });\n    }\n    \n    // \u6392\u5E8F\u51FD\u6570\n    function sortCollections(cards, sortBy) {\n        return [...cards].sort((a, b) => {\n            const aValue = a.dataset[sortBy];\n            const bValue = b.dataset[sortBy];\n\n            if (sortBy === 'views') {\n                return parseInt(bValue, 10) - parseInt(aValue, 10);\n            }\n            // For dates, we want descending order\n            return new Date(bValue) - new Date(aValue);\n        });\n    }\n\n    // \u7B5B\u9009\u548C\u6392\u5E8F\u4E3B\u51FD\u6570\n    function filterAndSort() {\n        const activeCategory = document.querySelector('.category-tab.active').dataset.category;\n        const searchTerm = searchInput.value.toLowerCase();\n        const sortBy = document.querySelector('.sort-button.active').dataset.sort;\n\n        // 1. \u7B5B\u9009\n        let filteredCards = allCollectionCards.filter(card => {\n            const cardCategory = card.dataset.category;\n            const cardTags = card.dataset.tags;\n            const cardTitle = card.querySelector('h3').textContent.toLowerCase();\n            \n            const matchesCategory = activeCategory === 'all' || cardCategory === activeCategory;\n            const matchesSearch = !searchTerm || cardTitle.includes(searchTerm) || cardTags.includes(searchTerm);\n            \n            return matchesCategory && matchesSearch;\n        });\n\n        // 2. \u6392\u5E8F\n        const sortedCards = sortCollections(filteredCards, sortBy);\n        \n        // 3. \u91CD\u7F6E\u5230\u7B2C\u4E00\u9875\n        currentPage = 1;\n        \n        // 4. \u6E32\u67D3\n        renderCollections(sortedCards);\n    }\n    \n    // \u5206\u9875\u63A7\u5236\u51FD\u6570\n    function goToPage(page) {\n        currentPage = page;\n        filterAndSort(); // \u91CD\u65B0\u6E32\u67D3\u5F53\u524D\u9875\n    }\n    \n    function goToFirstPage() {\n        goToPage(1);\n    }\n    \n    function goToPrevPage() {\n        if (currentPage > 1) {\n            goToPage(currentPage - 1);\n        }\n    }\n    \n    function goToNextPage() {\n        // \u603B\u9875\u6570\u4F1A\u5728renderCollections\u4E2D\u8BA1\u7B97\uFF0C\u8FD9\u91CC\u7B80\u5355\u5904\u7406\n        goToPage(currentPage + 1);\n    }\n    \n    function goToLastPage() {\n        // \u603B\u9875\u6570\u4F1A\u5728renderCollections\u4E2D\u8BA1\u7B97\uFF0C\u8FD9\u91CC\u7B80\u5355\u5904\u7406\n        goToPage(9999); // \u4E00\u4E2A\u8DB3\u591F\u5927\u7684\u6570\uFF0C\u4F1A\u5728renderCollections\u4E2D\u88AB\u4FEE\u6B63\n    }\n\n    // \u4E8B\u4EF6\u76D1\u542C\n    categoryTabs.forEach(tab => {\n        tab.addEventListener('click', () => {\n            categoryTabs.forEach(t => t.classList.remove('active'));\n            tab.classList.add('active');\n            filterAndSort();\n        });\n    });\n\n    searchInput.addEventListener('input', filterAndSort);\n    sortButtons.forEach(button => {\n        button.addEventListener('click', () => {\n            sortButtons.forEach(btn => btn.classList.remove('active'));\n            button.classList.add('active');\n            filterAndSort();\n        });\n    });\n    \n    // \u5206\u9875\u6309\u94AE\u4E8B\u4EF6\u76D1\u542C\n    firstPageBtn.addEventListener('click', goToFirstPage);\n    prevPageBtn.addEventListener('click', goToPrevPage);\n    nextPageBtn.addEventListener('click', goToNextPage);\n    lastPageBtn.addEventListener('click', goToLastPage);\n\n    // \u83B7\u53D6\u5E76\u66F4\u65B0\u6240\u6709\u8BBF\u95EE\u6B21\u6570\n    async function fetchAllViews() {\n        console.log('fetchAllViews called');\n        try {\n            const response = await fetch('/api/get-all-views');\n            console.log('API response status:', response.status);\n            if (!response.ok) {\n                console.log('API response not ok');\n                return;\n            }\n            const views = await response.json();\n            console.log('Data received from API:', views);\n            \n            allCollectionCards.forEach(card => {\n                const collectionId = card.dataset.id;\n                if (views[collectionId] !== undefined) {\n                    const viewCountSpan = card.querySelector('.view-count');\n                    if (viewCountSpan) {\n                        viewCountSpan.textContent = views[collectionId];\n                    }\n                    // \u66F4\u65B0\u5361\u7247\u4E0A\u7684 data-views \u5C5E\u6027\u4EE5\u4FBF\u6392\u5E8F\n                    card.dataset.views = views[collectionId];\n                }\n            });\n            // \u83B7\u53D6\u6570\u636E\u540E\u91CD\u65B0\u6392\u5E8F\u548C\u6E32\u67D3\n            filterAndSort();\n        } catch (error) {\n            console.error('Failed to fetch all views:', error);\n        }\n    }\n\n    // \u521D\u59CB\u52A0\u8F7D\n    window.addEventListener('pageshow', (event) => {\n        // \u6BCF\u6B21\u9875\u9762\u663E\u793A\u65F6\u90FD\u83B7\u53D6\u6700\u65B0\u6570\u636E\n        fetchAllViews();\n        // \u5982\u679C\u9875\u9762\u662F\u4ECE\u7F13\u5B58\u4E2D\u52A0\u8F7D\u7684\uFF0C\u6211\u4EEC\u53EF\u80FD\u9700\u8981\u91CD\u65B0\u521D\u59CB\u5316\u4E00\u4E9B\u72B6\u6001\n        if (event.persisted) {\n            console.log(\"Page was loaded from the cache.\");\n            // \u53EF\u4EE5\u5728\u8FD9\u91CC\u6DFB\u52A0\u9700\u8981\u91CD\u65B0\u521D\u59CB\u5316\u7684\u903B\u8F91\n        }\n        // \u786E\u4FDD\u7B5B\u9009\u548C\u6392\u5E8F\u5728\u6570\u636E\u66F4\u65B0\u540E\u6267\u884C\n        // fetchAllViews \u5185\u90E8\u5DF2\u7ECF\u8C03\u7528\u4E86 filterAndSort\n    });\n\n    // \u9875\u9762\u521D\u6B21\u52A0\u8F7D\u65F6\uFF0C\u4E5F\u6267\u884C\u4E00\u6B21\u6392\u5E8F\n    filterAndSort();\n\n        // \u6392\u5E8F\u51FD\u6570\n        function sortCollections(cards, sortBy) {\n            return [...cards].sort((a, b) => {\n                const aValue = a.dataset[sortBy];\n                const bValue = b.dataset[sortBy];\n\n                if (sortBy === 'views') {\n                    return parseInt(bValue, 10) - parseInt(aValue, 10);\n                }\n                // For dates, we want descending order\n                return new Date(bValue) - new Date(aValue);\n            });\n        }\n\n        // \u7B5B\u9009\u548C\u6392\u5E8F\u4E3B\u51FD\u6570\n        function filterAndSort() {\n            const activeCategory = document.querySelector('.category-tab.active').dataset.category;\n            const searchTerm = searchInput.value.toLowerCase();\n            const sortBy = document.querySelector('.sort-button.active').dataset.sort;\n\n            // 1. \u7B5B\u9009\n            let filteredCards = allCollectionCards.filter(card => {\n                const cardCategory = card.dataset.category;\n                const cardTags = card.dataset.tags;\n                const cardTitle = card.querySelector('h3').textContent.toLowerCase();\n                \n                const matchesCategory = activeCategory === 'all' || cardCategory === activeCategory;\n                const matchesSearch = !searchTerm || cardTitle.includes(searchTerm) || cardTags.includes(searchTerm);\n                \n                return matchesCategory && matchesSearch;\n            });\n\n            // 2. \u6392\u5E8F\n            const sortedCards = sortCollections(filteredCards, sortBy);\n            \n            // 3. \u6E32\u67D3\n            renderCollections(sortedCards);\n        }\n\n        // \u4E8B\u4EF6\u76D1\u542C\n        categoryTabs.forEach(tab => {\n            tab.addEventListener('click', () => {\n                categoryTabs.forEach(t => t.classList.remove('active'));\n                tab.classList.add('active');\n                filterAndSort();\n            });\n        });\n\n        searchInput.addEventListener('input', filterAndSort);\n        sortButtons.forEach(button => {\n            button.addEventListener('click', () => {\n                sortButtons.forEach(btn => btn.classList.remove('active'));\n                button.classList.add('active');\n                filterAndSort();\n            });\n        });\n\n        // \u83B7\u53D6\u5E76\u66F4\u65B0\u6240\u6709\u8BBF\u95EE\u6B21\u6570\n        async function fetchAllViews() {\n            console.log('fetchAllViews called');\n            try {\n                const response = await fetch('/api/get-all-views');\n                console.log('API response status:', response.status);\n                if (!response.ok) {\n                    console.log('API response not ok');\n                    return;\n                }\n                const views = await response.json();\n                console.log('Data received from API:', views);\n                \n                allCollectionCards.forEach(card => {\n                    const collectionId = card.dataset.id;\n                    if (views[collectionId] !== undefined) {\n                        const viewCountSpan = card.querySelector('.view-count');\n                        if (viewCountSpan) {\n                            viewCountSpan.textContent = views[collectionId];\n                        }\n                        // \u66F4\u65B0\u5361\u7247\u4E0A\u7684 data-views \u5C5E\u6027\u4EE5\u4FBF\u6392\u5E8F\n                        card.dataset.views = views[collectionId];\n                    }\n                });\n                // \u83B7\u53D6\u6570\u636E\u540E\u91CD\u65B0\u6392\u5E8F\u548C\u6E32\u67D3\n                filterAndSort();\n            } catch (error) {\n                console.error('Failed to fetch all views:', error);\n            }\n        }\n\n        // \u521D\u59CB\u52A0\u8F7D\n        window.addEventListener('pageshow', (event) => {\n            // \u6BCF\u6B21\u9875\u9762\u663E\u793A\u65F6\u90FD\u83B7\u53D6\u6700\u65B0\u6570\u636E\n            fetchAllViews();\n            // \u5982\u679C\u9875\u9762\u662F\u4ECE\u7F13\u5B58\u4E2D\u52A0\u8F7D\u7684\uFF0C\u6211\u4EEC\u53EF\u80FD\u9700\u8981\u91CD\u65B0\u521D\u59CB\u5316\u4E00\u4E9B\u72B6\u6001\n            if (event.persisted) {\n                console.log(\"Page was loaded from the cache.\");\n                // \u53EF\u4EE5\u5728\u8FD9\u91CC\u6DFB\u52A0\u9700\u8981\u91CD\u65B0\u521D\u59CB\u5316\u7684\u903B\u8F91\n            }\n            // \u786E\u4FDD\u7B5B\u9009\u548C\u6392\u5E8F\u5728\u6570\u636E\u66F4\u65B0\u540E\u6267\u884C\n            // fetchAllViews \u5185\u90E8\u5DF2\u7ECF\u8C03\u7528\u4E86 filterAndSort\n        });\n\n})();<\/script> "])), maybeRenderHead(), categories.map((category) => renderTemplate`<button class="category-tab"${addAttribute(category.id, "data-category")} data-astro-cid-j7pv25f6> <i${addAttribute(`fas ${category.icon} mr-2`, "class")} data-astro-cid-j7pv25f6></i> ${category.name} </button>`), collections.map((collection) => {
    const category = categories.find((cat) => cat.id === collection.category);
    return renderTemplate`<div class="ios-card collection-card p-6"${addAttribute(collection.id, "data-id")}${addAttribute(collection.category, "data-category")}${addAttribute(collection.tags.join(",").toLowerCase(), "data-tags")}${addAttribute(collection.views || 0, "data-views")}${addAttribute(collection.updated, "data-updated")}${addAttribute(collection.created, "data-created")} data-astro-cid-j7pv25f6> <!-- 集合封面 --> <div class="mb-4" data-astro-cid-j7pv25f6> ${collection.cover ? renderTemplate`<div class="collection-cover overflow-hidden" data-astro-cid-j7pv25f6> <img${addAttribute(collection.cover, "src")}${addAttribute(collection.title, "alt")} class="w-full h-full object-cover" onError="this.style.display='none'; this.nextElementSibling.style.display='flex';" data-astro-cid-j7pv25f6> <div class="collection-cover flex items-center justify-center text-white text-4xl" style="display: none;" data-astro-cid-j7pv25f6> <i${addAttribute(`fas ${category?.icon || "fa-folder"}`, "class")} data-astro-cid-j7pv25f6></i> </div> </div>` : renderTemplate`<div class="collection-cover flex items-center justify-center text-white text-4xl" data-astro-cid-j7pv25f6> <i${addAttribute(`fas ${category?.icon || "fa-folder"}`, "class")} data-astro-cid-j7pv25f6></i> </div>`} </div> <!-- 集合信息 --> <div class="mb-4" data-astro-cid-j7pv25f6> <div class="flex items-center justify-between mb-2" data-astro-cid-j7pv25f6> <h3 class="text-xl font-semibold text-ios-dark line-clamp-2" data-astro-cid-j7pv25f6>${collection.title}</h3> <span${addAttribute(`platform-icon ${category?.color || "bg-gray-500"} text-xs px-2 py-1 rounded-full`, "class")} data-astro-cid-j7pv25f6> <i${addAttribute(`fas ${category?.icon || "fa-folder"}`, "class")} data-astro-cid-j7pv25f6></i> </span> </div> <p class="text-ios-gray text-sm mb-3 line-clamp-2" data-astro-cid-j7pv25f6>${collection.description}</p> <!-- 标签 --> <div class="flex flex-wrap gap-1 mb-3" data-astro-cid-j7pv25f6> ${collection.tags.slice(0, 3).map((tag) => renderTemplate`<span class="platform-tag text-xs" data-astro-cid-j7pv25f6>${tag}</span>`)} ${collection.tags.length > 3 && renderTemplate`<span class="platform-tag text-xs" data-astro-cid-j7pv25f6>+${collection.tags.length - 3}</span>`} </div> <!-- 统计信息 --> <div class="flex items-center justify-between text-sm text-ios-gray" data-astro-cid-j7pv25f6> <span data-astro-cid-j7pv25f6> <i class="fas fa-file-alt mr-1" data-astro-cid-j7pv25f6></i> ${collection.resourceCount} 个资源
</span> <span data-astro-cid-j7pv25f6> <i class="fas fa-eye mr-1" data-astro-cid-j7pv25f6></i> <span class="view-count" data-astro-cid-j7pv25f6>${collection.views || 0}</span> 次访问
</span> <span data-astro-cid-j7pv25f6> <i class="fas fa-clock mr-1" data-astro-cid-j7pv25f6></i> ${new Date(collection.updated).toLocaleDateString("zh-CN")} </span> </div> </div> <!-- 操作按钮 --> <div class="flex gap-2" data-astro-cid-j7pv25f6> <a${addAttribute(`/collection?id=${collection.id}`, "href")} class="flex-1 bg-gradient-to-r from-ios-blue to-blue-500 text-white rounded-xl py-2 px-4 font-medium hover:opacity-90 transition-opacity text-center" data-astro-cid-j7pv25f6>
查看详情
</a> </div> </div>`;
  }), defineScriptVars({ collections, platformMap })) })}`;
}, "/Users/hua/Documents/vhost/pansou-ui/collections/src/pages/index.astro", void 0);

const $$file = "/Users/hua/Documents/vhost/pansou-ui/collections/src/pages/index.astro";
const $$url = "";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
    __proto__: null,
    default: $$Index,
    file: $$file,
    url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
